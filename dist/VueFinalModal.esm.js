import{ref as e,inject as n,reactive as t,computed as o,watch as a,onMounted as l,onBeforeUnmount as r,nextTick as i,withDirectives as d,openBlock as f,createBlock as u,createVNode as v,Transition as c,vShow as s,withModifiers as m,renderSlot as p,createCommentVNode as y,withScopeId as b}from"vue";function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var g=function(e){return!(!e||e.nodeType!==Node.ELEMENT_NODE)},S=function(e,n){n&&g(e)&&(e.style[n]="")};var C={name:"VueFinalModal",props:{name:{type:String,default:null},modelValue:{type:Boolean,default:!1},ssr:{type:Boolean,default:!0},classes:{type:[String,Object,Array],default:""},overlayClass:{type:[String,Object,Array],default:""},contentClass:{type:[String,Object,Array],default:""},lockScroll:{type:Boolean,default:!0},hideOverlay:{type:Boolean,default:!1},clickToClose:{type:Boolean,default:!0},preventClick:{type:Boolean,default:!1},attach:{type:null,default:!1,validator:function(e){var n=h(e);return"boolean"===n||"string"===n||e.nodeType===Node.ELEMENT_NODE}},transition:{type:String,default:"vfm"},overlayTransition:{type:String,default:"vfm"},zIndexBase:{type:[String,Number],default:1e3},zIndex:{type:[Boolean,String,Number],default:!1}},emits:["update:modelValue","click-outside","before-open","opened","before-close","closed"],setup:function(d,f){var u=f.emit,v="enter",c="entering",s="leave",m="leavng",p=Symbol("vfm"),y=e(null),b=e(null),h=e(null),C=n("$vfm"),M=e(null),x=e(!1),k=t({modal:!1,overlay:!1}),E=e(null),O=e(null),B=o((function(){return(d.hideOverlay||E.value===s)&&O.value===s})),A=o((function(){return"boolean"==typeof d.zIndex?d.attach?"unset":d.zIndexBase+2*(M.value||0):d.zIndex}));function I(){return{uid:p,name:d.name,emit:u,vfmContent:b,getAttachElement:V,modalStackIndex:M,visibility:k,handleLockScroll:T,hideOverlay:d.hideOverlay}}function _(){if(d.modelValue){var e=V();if(e||!1===d.attach){!1!==d.attach&&e.appendChild(y.value);var n=C.openedModals.findIndex((function(e){return e.uid===p}));-1!==n&&C.openedModals.splice(n,1),C.openedModals.push(I()),M.value=C.openedModals.length-1,T(),C.openedModals.filter((function(e){return e.uid!==p})).forEach((function(n,t){n.getAttachElement()===e&&(n.modalStackIndex.value=t,n.visibility.overlay=!1)})),x.value=!0,i((function(){k.overlay=!0,k.modal=!0}))}else!1!==e&&console.warn("Unable to locate target ".concat(d.attach))}}function L(){var e=C.openedModals.findIndex((function(e){return e.uid===p}));if(-1!==e&&C.openedModals.splice(e,1),C.openedModals.length>0){var n=C.openedModals[C.openedModals.length-1];n.handleLockScroll(),!n.hideOverlay&&(n.visibility.overlay=!0)}else d.lockScroll&&S(document.body,"overflow");k.overlay=!1,k.modal=!1}function T(){var e,n,t;d.modelValue&&(d.lockScroll?(e=document.body,t="hidden",(n="overflow")&&g(e)&&(e.style[n]=t)):S(document.body,"overflow"))}function V(){return!1!==d.attach&&("string"==typeof d.attach?!!window&&window.document.querySelector(d.attach):d.attach)}return a((function(){return d.modelValue}),(function(e){_(),e||L()})),a((function(){return d.lockScroll}),T),a((function(){return d.hideOverlay}),(function(e){d.modelValue&&!e&&(k.overlay=!0)})),a((function(){return d.attach}),_),a(B,(function(e){e&&(x.value=!1)}),{flush:"post"}),C.modals.push(I()),l((function(){_()})),r((function(){L(),y.value.remove();var e=C.modals.findIndex((function(e){return e.uid===p}));C.openedModals.splice(e,1)})),{root:y,vfmContent:b,vfmContainer:h,visible:x,visibility:k,calculateZIndex:A,beforeOverlayEnter:function(){E.value=c},afterOverlayEnter:function(){E.value=v},beforeOverlayLeave:function(){E.value=m},afterOverlayLeave:function(){E.value=s},beforeModalEnter:function(){u("before-open"),O.value=c},afterModalEnter:function(){O.value=v,h.value.focus(),u("opened")},beforeModalLeave:function(){u("before-close"),O.value=m},afterModalLeave:function(){O.value=s,M.value=null,u("closed")},onClickContainer:function(){u("click-outside"),d.clickToClose&&u("update:modelValue",!1)}}}};const M=b("data-v-2836fdb5"),x=M((function(e,n,t,o,a,l){return t.ssr||o.visible?d((f(),u("div",{key:0,ref:"root",style:{zIndex:o.calculateZIndex},class:["vfm vfm--inset",[!1===t.attach?"vfm--fixed":"vfm--absolute",{"vfm--prevent-none":t.preventClick}]]},[v(c,{name:t.overlayTransition,"onBefore-enter":o.beforeOverlayEnter,"onAfter-enter":o.afterOverlayEnter,"onBefore-leave":o.beforeOverlayLeave,"onAfter-leave":o.afterOverlayLeave},{default:M((()=>[d(v("div",{class:["vfm__overlay vfm--overlay vfm--absolute vfm--inset",t.overlayClass],"aria-expanded":o.visibility.overlay.toString()},null,10,["aria-expanded"]),[[s,!t.hideOverlay&&o.visibility.overlay]])])),_:1},8,["name","onBefore-enter","onAfter-enter","onBefore-leave","onAfter-leave"]),v(c,{name:t.transition,"onBefore-enter":o.beforeModalEnter,"onAfter-enter":o.afterModalEnter,"onBefore-leave":o.beforeModalLeave,"onAfter-leave":o.afterModalLeave},{default:M((()=>[d(v("div",{ref:"vfmContainer",class:["vfm__container vfm--absolute vfm--inset vfm--outline-none",[t.classes,{"vfm--cursor-pointer":t.clickToClose}]],"aria-expanded":o.visibility.modal.toString(),role:"dialog","aria-modal":"true",tabindex:"-1",onClick:n[2]||(n[2]=(...e)=>o.onClickContainer(...e))},[v("div",{ref:"vfmContent",class:["vfm__content vfm--cursor-auto",[t.contentClass,{"vfm--prevent-auto":t.preventClick}]],onClick:n[1]||(n[1]=m((()=>{}),["stop"]))},[p(e.$slots,"default")],2)],10,["aria-expanded"]),[[s,o.visibility.modal]])])),_:3},8,["name","onBefore-enter","onAfter-enter","onBefore-leave","onAfter-leave"])],6)),[[s,!t.ssr||o.visible]]):y("v-if",!0)}));!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===t&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}("\n.vfm--fixed[data-v-2836fdb5] {\n  position: fixed;\n}\n.vfm--absolute[data-v-2836fdb5] {\n  position: absolute;\n}\n.vfm--inset[data-v-2836fdb5] {\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.vfm--overlay[data-v-2836fdb5] {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.vfm--prevent-none[data-v-2836fdb5] {\n  pointer-events: none;\n}\n.vfm--prevent-auto[data-v-2836fdb5] {\n  pointer-events: auto;\n}\n.vfm--cursor-pointer[data-v-2836fdb5] {\n  cursor: pointer;\n}\n.vfm--cursor-auto[data-v-2836fdb5] {\n  cursor: auto;\n}\n.vfm--outline-none[data-v-2836fdb5]:focus {\n  outline: none;\n}\n.vfm-enter-active[data-v-2836fdb5],\n.vfm-leave-active[data-v-2836fdb5] {\n  transition: opacity 0.2s;\n}\n.vfm-enter-from[data-v-2836fdb5],\n.vfm-leave-to[data-v-2836fdb5] {\n  opacity: 0;\n}\n"),C.render=x,C.__scopeId="data-v-2836fdb5",C.__file="lib/VueFinalModal.vue";var k={install:function(e){if(!e.config.globalProperties.$vfm){var n=function(){var e;return function(){return e||(e={openedModals:[],modals:[],show:function(e){this.toggle(e,!0)},hide:function(e){this.toggle(e,!1)},hideAll:function(){this.openedModals.forEach((function(e){e.emit("update:modelValue",!1)}))},toggle:function(e,n){var t=this.modals.find((function(n){return n.name===e}));void 0!==t&&t.emit("update:modelValue",n)}}),e}}()();Object.defineProperty(e.config.globalProperties,"$vfm",{get:function(){return n}}),e.provide("$vfm",n),e.component("VueFinalModal",C)}}};export default k;
